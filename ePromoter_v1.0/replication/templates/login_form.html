<!-- 로그인 폼 조각. 로그인 페이지에 삽입 -->
<form class="login_frm" id="loginForm" name="loginForm" method="post" action="javascript:login()">
    <div class="login_form">
        <div class="ipt_wrap">
            <label for="user_id">아이디</label>
            <input type="email" id="user_id" name="id" placeholder="ID" required>
        </div>
        <div class="ipt_wrap">
            <label for="user_pw">비밀번호</label>
            <input type="password" id="user_pw" name="user_pw" placeholder="Password" required>
        </div>
        <span class="warn_msg"></span>
    </div>
    <a href="javascript:login()" class="login_btn_img">
        <img src="img/login_02.png" alt="Log-in">
    </a>
</form>

<script>
function login() {
    var user_id = document.getElementById('user_id').value.trim();
    var user_pw = document.getElementById('user_pw').value;
    if (!user_id) { alert('Please input your ID'); return; }
    if (!user_pw) { alert('Please input your Password'); return; }
    fetch('/globaldashboard/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include',
        body: JSON.stringify({ user_id: user_id, user_pw: user_pw })
    })
    .then(function(r) { return r.json(); })
    .then(function(res) {
        if (res.ok) {
            if (res.data === 1)
                alert('Data is under processing. You may still access but data may vary.');
            window.location.href = '/globaldashboard/main';
        } else {
            alert(res.data || 'Login failed');
        }
    })
    .catch(function(e) { alert('Request failed'); });
}
</script>
